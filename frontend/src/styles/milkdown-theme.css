/* Dark theme (default) */
.dark .milkdown-editor-wrapper {
  background: #171717;
  color: #e5e5e5;
}

/* Light theme */
.light .milkdown-editor-wrapper {
  background: #ffffff;
  color: #1a1a1a;
}

.milkdown {
  background: transparent !important;
}

/* Dark theme editor */
.dark .milkdown .editor {
  background: transparent !important;
  color: #e5e5e5 !important;
  outline: none !important;
  padding: 0 !important;
}

/* Light theme editor */
.light .milkdown .editor {
  background: transparent !important;
  color: #1a1a1a !important;
  outline: none !important;
  padding: 0 !important;
}

.milkdown .ProseMirror {
  outline: none !important;
}

/* Typography - Dark theme */
.dark .milkdown .editor h1,
.dark .milkdown .ProseMirror h1 {
  color: #f5f5f5 !important;
  font-size: 2.25rem !important;
  font-weight: 700 !important;
  line-height: 2.5rem !important;
  margin-top: 0 !important;
  margin-bottom: 1rem !important;
  border-bottom: 1px solid #404040 !important;
  padding-bottom: 0.5rem !important;
}

/* Typography - Light theme */
.light .milkdown .editor h1,
.light .milkdown .ProseMirror h1 {
  color: #0a0a0a !important;
  font-size: 2.25rem !important;
  font-weight: 700 !important;
  line-height: 2.5rem !important;
  margin-top: 0 !important;
  margin-bottom: 1rem !important;
  border-bottom: 1px solid #e5e5e5 !important;
  padding-bottom: 0.5rem !important;
}

.dark .milkdown .editor h2,
.dark .milkdown .ProseMirror h2 {
  color: #f5f5f5 !important;
  font-size: 1.875rem !important;
  font-weight: 600 !important;
  line-height: 2.25rem !important;
  margin-top: 1.5rem !important;
  margin-bottom: 1rem !important;
  border-bottom: 1px solid #404040 !important;
  padding-bottom: 0.5rem !important;
}

.light .milkdown .editor h2,
.light .milkdown .ProseMirror h2 {
  color: #0a0a0a !important;
  font-size: 1.875rem !important;
  font-weight: 600 !important;
  line-height: 2.25rem !important;
  margin-top: 1.5rem !important;
  margin-bottom: 1rem !important;
  border-bottom: 1px solid #e5e5e5 !important;
  padding-bottom: 0.5rem !important;
}

.dark .milkdown .editor h3,
.dark .milkdown .ProseMirror h3,
.dark .milkdown .editor h4,
.dark .milkdown .ProseMirror h4,
.dark .milkdown .editor h5,
.dark .milkdown .ProseMirror h5,
.dark .milkdown .editor h6,
.dark .milkdown .ProseMirror h6 {
  color: #f5f5f5 !important;
  font-weight: 600 !important;
}

.dark .milkdown .editor h3,
.dark .milkdown .ProseMirror h3 {
  font-size: 1.5rem !important;
  line-height: 2rem !important;
  margin-top: 1.5rem !important;
  margin-bottom: 0.75rem !important;
}

.dark .milkdown .editor h4,
.dark .milkdown .ProseMirror h4 {
  font-size: 1.25rem !important;
  line-height: 1.75rem !important;
  margin-top: 1.25rem !important;
  margin-bottom: 0.75rem !important;
}

.dark .milkdown .editor h5,
.dark .milkdown .ProseMirror h5 {
  font-size: 1.125rem !important;
  line-height: 1.75rem !important;
  margin-top: 1rem !important;
  margin-bottom: 0.5rem !important;
}

.dark .milkdown .editor h6,
.dark .milkdown .ProseMirror h6 {
  font-size: 1rem !important;
  line-height: 1.5rem !important;
  margin-top: 1rem !important;
  margin-bottom: 0.5rem !important;
}

.light .milkdown .editor h3,
.light .milkdown .ProseMirror h3,
.light .milkdown .editor h4,
.light .milkdown .ProseMirror h4,
.light .milkdown .editor h5,
.light .milkdown .ProseMirror h5,
.light .milkdown .editor h6,
.light .milkdown .ProseMirror h6 {
  color: #0a0a0a !important;
  font-weight: 600 !important;
}

.light .milkdown .editor h3,
.light .milkdown .ProseMirror h3 {
  font-size: 1.5rem !important;
  line-height: 2rem !important;
  margin-top: 1.5rem !important;
  margin-bottom: 0.75rem !important;
}

.light .milkdown .editor h4,
.light .milkdown .ProseMirror h4 {
  font-size: 1.25rem !important;
  line-height: 1.75rem !important;
  margin-top: 1.25rem !important;
  margin-bottom: 0.75rem !important;
}

.light .milkdown .editor h5,
.light .milkdown .ProseMirror h5 {
  font-size: 1.125rem !important;
  line-height: 1.75rem !important;
  margin-top: 1rem !important;
  margin-bottom: 0.5rem !important;
}

.light .milkdown .editor h6,
.light .milkdown .ProseMirror h6 {
  font-size: 1rem !important;
  line-height: 1.5rem !important;
  margin-top: 1rem !important;
  margin-bottom: 0.5rem !important;
}

/* Generic fallback styles */
.milkdown .editor h3,
.milkdown .ProseMirror h3 {
  color: #f5f5f5 !important;
  font-size: 1.5rem !important;
  font-weight: 600 !important;
  line-height: 2rem !important;
  margin-top: 1.5rem !important;
  margin-bottom: 0.75rem !important;
}

.milkdown .editor h4,
.milkdown .ProseMirror h4 {
  color: #f5f5f5 !important;
  font-size: 1.25rem !important;
  font-weight: 600 !important;
  line-height: 1.75rem !important;
  margin-top: 1.25rem !important;
  margin-bottom: 0.75rem !important;
}

.milkdown .editor h5,
.milkdown .ProseMirror h5 {
  color: #f5f5f5 !important;
  font-size: 1.125rem !important;
  font-weight: 600 !important;
  line-height: 1.75rem !important;
  margin-top: 1rem !important;
  margin-bottom: 0.5rem !important;
}

.milkdown .editor h6,
.milkdown .ProseMirror h6 {
  color: #f5f5f5 !important;
  font-size: 1rem !important;
  font-weight: 600 !important;
  line-height: 1.5rem !important;
  margin-top: 1rem !important;
  margin-bottom: 0.5rem !important;
}

.milkdown .editor p,
.milkdown .ProseMirror p {
  color: #e5e5e5 !important;
  line-height: 1.7 !important;
  margin-top: 0.75rem !important;
  margin-bottom: 0.75rem !important;
}

.milkdown .editor a,
.milkdown .ProseMirror a {
  color: #60a5fa !important;
  text-decoration: underline !important;
  cursor: text !important;
}

.milkdown .editor a:hover,
.milkdown .ProseMirror a:hover {
  color: #93c5fd !important;
}

/* Code - Inline */
.milkdown .editor code:not(pre code),
.milkdown .ProseMirror code:not(pre code) {
  background: #262626 !important;
  color: #fbbf24 !important;
  padding: 0.2em 0.4em !important;
  border-radius: 3px !important;
  font-size: 0.875em !important;
}

/* Code blocks */
.milkdown .editor pre,
.milkdown .ProseMirror pre {
  background: #0a0a0a !important;
  border: 1px solid #262626 !important;
  padding: 1rem !important;
  overflow-x: auto !important;
}

.milkdown .editor pre code,
.milkdown .ProseMirror pre code {
  background: transparent !important;
  color: #e5e5e5 !important;
  padding: 0 !important;
  font-size: 0.875rem !important;
  line-height: 1.5 !important;
  display: block !important;
}

/* Lists */
.milkdown ul,
.milkdown ol {
  color: #e5e5e5 !important;
  padding-left: 2rem !important;
  margin: 1rem 0 !important;
}

.milkdown ul {
  list-style-type: disc !important;
}

.milkdown ol {
  list-style-type: decimal !important;
}

.milkdown li {
  color: #e5e5e5 !important;
  margin: 0.5rem 0 !important;
  display: list-item !important;
}

.milkdown li::marker {
  color: #a3a3a3 !important;
}

/* Blockquote */
.milkdown blockquote {
  border-left: 4px solid #404040 !important;
  color: #a3a3a3 !important;
  padding-left: 1rem !important;
  margin: 1rem 0 !important;
  font-style: italic;
}

/* Tables */
.milkdown table {
  border-collapse: collapse !important;
  border: 1px solid #262626 !important;
  width: 100% !important;
}

.milkdown th,
.milkdown td {
  border: 1px solid #262626 !important;
  padding: 0.75rem !important;
  color: #e5e5e5 !important;
}

.milkdown th {
  background: #262626 !important;
  font-weight: 600 !important;
}

.milkdown tr:hover {
  background: #1a1a1a !important;
}

/* Horizontal rule */
.milkdown hr {
  border: none !important;
  border-top: 1px solid #404040 !important;
  margin: 2rem 0 !important;
}

/* Task lists */
.milkdown input[type="checkbox"] {
  margin-right: 0.5rem !important;
  accent-color: #60a5fa !important;
}

/* Selection */
.milkdown ::selection {
  background: #3b82f6 !important;
  color: white !important;
}

/* Placeholder */
.milkdown .ProseMirror-placeholder {
  color: #525252 !important;
}

/* Focus */
.milkdown .editor:focus {
  outline: none !important;
}

/* Scrollbar */
.milkdown::-webkit-scrollbar {
  display: none !important;
}

/* Override Nord theme colors */
.milkdown-theme-dark {
  --nord0: #171717;
  --nord1: #262626;
  --nord2: #404040;
  --nord3: #525252;
  --nord4: #a3a3a3;
  --nord5: #e5e5e5;
  --nord6: #f5f5f5;
  --nord8: #60a5fa;
  --nord9: #93c5fd;
  --nord10: #3b82f6;
  --nord13: #fbbf24;
  --nord14: #65d9af;
  --nord15: #f87171;
}

/* Strong/Bold */
.milkdown strong {
  color: #f5f5f5 !important;
  font-weight: 600 !important;
}

/* Emphasis/Italic */
.milkdown em {
  color: #e5e5e5 !important;
  font-style: italic !important;
}

/* Strikethrough */
.milkdown del {
  color: #a3a3a3 !important;
  text-decoration: line-through !important;
}

/* Prism Syntax Highlighting Overrides for Dark Theme */
.milkdown .token.comment,
.milkdown .token.prolog,
.milkdown .token.doctype,
.milkdown .token.cdata {
  color: #6b7280 !important;
}

.milkdown .token.punctuation {
  color: #9ca3af !important;
}

.milkdown .token.property,
.milkdown .token.tag,
.milkdown .token.boolean,
.milkdown .token.number,
.milkdown .token.constant,
.milkdown .token.symbol,
.milkdown .token.deleted {
  color: #f87171 !important;
}

.milkdown .token.selector,
.milkdown .token.attr-name,
.milkdown .token.string,
.milkdown .token.char,
.milkdown .token.builtin,
.milkdown .token.inserted {
  color: #34d399 !important;
}

.milkdown .token.operator,
.milkdown .token.entity,
.milkdown .token.url,
.milkdown .language-css .token.string,
.milkdown .style .token.string {
  color: #60a5fa !important;
}

.milkdown .token.atrule,
.milkdown .token.attr-value,
.milkdown .token.keyword {
  color: #a78bfa !important;
}

.milkdown .token.function,
.milkdown .token.class-name {
  color: #fbbf24 !important;
}

.milkdown .token.regex,
.milkdown .token.important,
.milkdown .token.variable {
  color: #fb923c !important;
}

/* Code block enhancements */
.milkdown .code-fence {
  position: relative;
  margin: 1.5rem 0;
}

.milkdown .code-fence-widget {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  display: flex;
  gap: 0.5rem;
  opacity: 0;
  transition: opacity 0.2s;
}

.milkdown .code-fence:hover .code-fence-widget {
  opacity: 1;
}

.milkdown .code-fence-copy-button {
  padding: 0.25rem 0.5rem;
  background: #374151;
  color: #d1d5db;
  border: 1px solid #4b5563;
  border-radius: 0.25rem;
  cursor: pointer;
  font-size: 0.75rem;
  transition: all 0.2s;
}

.milkdown .code-fence-copy-button:hover {
  background: #4b5563;
  color: #f3f4f6;
}

.milkdown .code-fence-copy-button.copied {
  background: #10b981;
  border-color: #10b981;
}

/* Line numbers for code blocks */
.milkdown pre[class*="language-"] {
  counter-reset: line-number;
  padding-left: 3.5rem;
}

.milkdown pre[class*="language-"] .line::before {
  counter-increment: line-number;
  content: counter(line-number);
  position: absolute;
  left: 0;
  width: 3rem;
  text-align: right;
  padding-right: 1rem;
  color: #6b7280;
  user-select: none;
}

.milkdown pre[class*="language-"] .line {
  position: relative;
  display: block;
}

/* Marker/Highlight styles */
.milkdown .editor mark,
.milkdown .ProseMirror mark {
  padding: 0.1em 0.2em !important;
  border-radius: 0.2em !important;
  color: #171717 !important;
  font-weight: 500 !important;
}

/* Dark theme compatible marker colors */
.milkdown-theme-dark .editor mark,
.milkdown-theme-dark .ProseMirror mark {
  box-shadow: 0 0 0 1px rgba(255, 255, 0, 0.2) !important;
}

/* Color Picker Tooltip */
.milkdown-color-picker {
  position: absolute;
  z-index: 1000;
  background: #262626;
  border: 1px solid #404040;
  border-radius: 6px;
  padding: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  display: flex;
  align-items: center;
  gap: 8px;
  pointer-events: all;
}

.milkdown-color-picker input[type="color"] {
  width: 40px;
  height: 40px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  background: transparent;
}

.milkdown-color-picker input[type="color"]::-webkit-color-swatch-wrapper {
  padding: 0;
}

.milkdown-color-picker input[type="color"]::-webkit-color-swatch {
  border: 2px solid #404040;
  border-radius: 4px;
}

.milkdown-color-picker-close {
  background: transparent;
  border: none;
  color: #e5e5e5;
  font-size: 24px;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border-radius: 4px;
  transition: background-color 0.2s;
  padding: 0;
  flex-shrink: 0;
  outline: none;
  user-select: none;
  -webkit-user-select: none;
}

.milkdown-color-picker-close:hover {
  background-color: #404040;
}

.milkdown-color-picker-close:active {
  background-color: #525252;
  transform: scale(0.95);
}

/* ── Code block wrapper (NodeView) ── */
.code-block-wrapper {
  position: relative;
  margin: 1rem 0 !important;
  border: 1px solid #262626;
  border-radius: 6px;
  overflow: hidden;
}

.code-block-wrapper pre {
  margin: 0 !important;
  border: none !important;
  border-radius: 0 !important;
}

.code-block-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 12px;
  background: #1a1a1a;
  border-bottom: 1px solid #262626;
  user-select: none;
  -webkit-user-select: none;
}

.code-block-lang-label {
  color: #737373;
  font-size: 0.75rem;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  cursor: pointer;
  padding: 2px 6px;
  border-radius: 3px;
  transition: all 0.15s;
}

.code-block-lang-label:hover {
  color: #a3a3a3;
  background: #262626;
}

.code-block-lang-select {
  color: #e5e5e5;
  font-size: 0.75rem;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  background: #262626;
  border: 1px solid #525252;
  border-radius: 3px;
  padding: 2px 6px;
  outline: none;
  cursor: pointer;
}

.code-block-lang-select:focus {
  border-color: #60a5fa;
}

.code-block-copy-btn {
  color: #737373;
  font-size: 0.75rem;
  background: transparent;
  border: 1px solid transparent;
  border-radius: 4px;
  padding: 2px 10px;
  cursor: pointer;
  transition: all 0.15s;
}

.code-block-copy-btn:hover {
  color: #e5e5e5;
  background: #333;
  border-color: #525252;
}

.code-block-copy-btn.copied {
  color: #34d399;
  opacity: 1;
}

/* ── Task list styling ── */
.milkdown li[data-item-type="task"] {
  list-style: none !important;
  display: flex !important;
  align-items: flex-start !important;
  gap: 8px !important;
}

.milkdown li[data-item-type="task"]::before {
  content: "";
  display: block;
  width: 16px;
  height: 16px;
  min-width: 16px;
  border: 2px solid #525252;
  border-radius: 3px;
  cursor: pointer;
  transition: all 0.15s;
  margin-top: 4px;
}

.milkdown li[data-item-type="task"]:hover::before {
  border-color: #60a5fa;
}

.milkdown li[data-item-type="task"][data-checked="true"]::before {
  background: #3b82f6;
  border-color: #3b82f6;
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
  background-size: 12px 12px;
  background-repeat: no-repeat;
  background-position: center;
}

.milkdown li[data-item-type="task"] > p {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  flex: 1;
}

/* ── Bottom padding for editor scrolling (fixes table at EOF) ── */
.milkdown .editor,
.milkdown .ProseMirror {
  padding-bottom: 20vh !important;
}
/* ═══════════════════════════════════════════════════════════════ */
/* ── LIGHT THEME OVERRIDES ──────────────────────────────────────  */
/* ═══════════════════════════════════════════════════════════════ */

.light .milkdown-editor-wrapper {
  background: #ffffff !important;
  color: #1a1a1a !important;
}

.light .milkdown .editor,
.light .milkdown .ProseMirror {
  color: #1a1a1a !important;
}

/* Light theme headings */
.light .milkdown .editor h1,
.light .milkdown .ProseMirror h1,
.light .milkdown .editor h2,
.light .milkdown .ProseMirror h2 {
  color: #0a0a0a !important;
  border-bottom-color: #e5e5e5 !important;
}

.light .milkdown .editor h3,
.light .milkdown .ProseMirror h3,
.light .milkdown .editor h4,
.light .milkdown .ProseMirror h4,
.light .milkdown .editor h5,
.light .milkdown .ProseMirror h5,
.light .milkdown .editor h6,
.light .milkdown .ProseMirror h6 {
  color: #0a0a0a !important;
}

/* Light theme text */
.light .milkdown .editor p,
.light .milkdown .ProseMirror p,
.light .milkdown ul,
.light .milkdown ol,
.light .milkdown li {
  color: #1a1a1a !important;
}

/* Light theme links */
.light .milkdown .editor a,
.light .milkdown .ProseMirror a {
  color: #2563eb !important;
}

.light .milkdown .editor a:hover,
.light .milkdown .ProseMirror a:hover {
  color: #1d4ed8 !important;
}

/* Light theme inline code */
.light .milkdown .editor code:not(pre code),
.light .milkdown .ProseMirror code:not(pre code) {
  background: #f5f5f5 !important;
  color: #d97706 !important;
}

/* Light theme code blocks */
.light .milkdown .editor pre,
.light .milkdown .ProseMirror pre {
  background: #fafafa !important;
  border: 1px solid #e5e5e5 !important;
}

.light .milkdown .editor pre code,
.light .milkdown .ProseMirror pre code {
  color: #1a1a1a !important;
}

/* Light theme blockquotes */
.light .milkdown blockquote {
  border-left-color: #d4d4d4 !important;
  color: #525252 !important;
  background: #fafafa !important;
}

.light .milkdown blockquote p {
  color: #525252 !important;
}

/* Light theme tables */
.light .milkdown table {
  border-color: #e5e5e5 !important;
}

.light .milkdown th,
.light .milkdown td {
  border-color: #e5e5e5 !important;
  color: #1a1a1a !important;
}

.light .milkdown th {
  background: #f5f5f5 !important;
}

.light .milkdown tr:nth-child(even) {
  background: #fafafa !important;
}

/* Light theme hr */
.light .milkdown hr {
  border-color: #e5e5e5 !important;
}

/* Light theme strong/em */
.light .milkdown strong {
  color: #0a0a0a !important;
}

.light .milkdown em {
  color: #404040 !important;
}

/* Light theme task lists */
.light .milkdown li[data-item-type="task"]::before {
  border-color: #a3a3a3 !important;
}

.light .milkdown li[data-item-type="task"]:hover::before {
  border-color: #2563eb !important;
}

.light .milkdown li[data-item-type="task"][data-checked="true"]::before {
  background: #2563eb !important;
  border-color: #2563eb !important;
}

/* Light theme code block copy button */
.light .code-block-copy-btn {
  color: #525252 !important;
  background: #ffffff !important;
  border-color: #d4d4d4 !important;
}

.light .code-block-copy-btn:hover {
  color: #1a1a1a !important;
  background: #f5f5f5 !important;
  border-color: #a3a3a3 !important;
}

.light .code-block-copy-btn.copied {
  color: #16a34a !important;
}
